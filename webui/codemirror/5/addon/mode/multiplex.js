// CodeMirror, copyright (c) by Marijn Haverbeke and others
// Distributed under an MIT license: http://codemirror.net/LICENSE
(function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)})(function(e){"use strict";e.multiplexingMode=function(t){function r(e,t,n,r){if(typeof t=="string"){var i=e.indexOf(t,n);return r&&i>-1?i+t.length:i}var s=t.exec(n?e.slice(n):e);return s?s.index+n+(r?s[0].length:0):-1}var n=Array.prototype.slice.call(arguments,1);return{startState:function(){return{outer:e.startState(t),innerActive:null,inner:null}},copyState:function(n){return{outer:e.copyState(t,n.outer),innerActive:n.innerActive,inner:n.innerActive&&e.copyState(n.innerActive.mode,n.inner)}},token:function(i,s){if(!s.innerActive){var o=Infinity,u=i.string;for(var a=0;a<n.length;++a){var f=n[a],l=r(u,f.open,i.pos);if(l==i.pos)return f.parseDelimiters||i.match(f.open),s.innerActive=f,s.inner=e.startState(f.mode,t.indent?t.indent(s.outer,""):0),f.delimStyle&&f.delimStyle+" "+f.delimStyle+"-open";l!=-1&&l<o&&(o=l)}o!=Infinity&&(i.string=u.slice(0,o));var c=t.token(i,s.outer);return o!=Infinity&&(i.string=u),c}var h=s.innerActive,u=i.string;if(!h.close&&i.sol())return s.innerActive=s.inner=null,this.token(i,s);var l=h.close?r(u,h.close,i.pos,h.parseDelimiters):-1;if(l==i.pos&&!h.parseDelimiters)return i.match(h.close),s.innerActive=s.inner=null,h.delimStyle&&h.delimStyle+" "+h.delimStyle+"-close";l>-1&&(i.string=u.slice(0,l));var p=h.mode.token(i,s.inner);return l>-1&&(i.string=u),l==i.pos&&h.parseDelimiters&&(s.innerActive=s.inner=null),h.innerStyle&&(p?p=p+" "+h.innerStyle:p=h.innerStyle),p},indent:function(n,r){var i=n.innerActive?n.innerActive.mode:t;return i.indent?i.indent(n.innerActive?n.inner:n.outer,r):e.Pass},blankLine:function(r){var i=r.innerActive?r.innerActive.mode:t;i.blankLine&&i.blankLine(r.innerActive?r.inner:r.outer);if(!r.innerActive)for(var s=0;s<n.length;++s){var o=n[s];o.open==="\n"&&(r.innerActive=o,r.inner=e.startState(o.mode,i.indent?i.indent(r.outer,""):0))}else r.innerActive.close==="\n"&&(r.innerActive=r.inner=null)},electricChars:t.electricChars,innerMode:function(e){return e.inner?{state:e.inner,mode:e.innerActive.mode}:{state:e.outer,mode:t}}}}});