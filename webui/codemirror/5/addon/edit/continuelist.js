// CodeMirror, copyright (c) by Marijn Haverbeke and others
// Distributed under an MIT license: http://codemirror.net/LICENSE
(function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)})(function(e){"use strict";var t=/^(\s*)(>[> ]*|[*+-]\s|(\d+)([.)]))(\s*)/,n=/^(\s*)(>[> ]*|[*+-]|(\d+)[.)])(\s*)$/,r=/[*+-]\s/;e.commands.newlineAndIndentContinueMarkdownList=function(i){if(i.getOption("disableInput"))return e.Pass;var s=i.listSelections(),o=[];for(var u=0;u<s.length;u++){var a=s[u].head,f=i.getStateAfter(a.line),l=f.list!==!1,c=f.quote!==0,h=i.getLine(a.line),p=t.exec(h);if(!s[u].empty()||!l&&!c||!p){i.execCommand("newlineAndIndent");return}if(n.test(h))i.replaceRange("",{line:a.line,ch:0},{line:a.line,ch:a.ch+1}),o[u]="\n";else{var d=p[1],v=p[5],m=r.test(p[2])||p[2].indexOf(">")>=0?p[2]:parseInt(p[3],10)+1+p[4];o[u]="\n"+d+m+v}}i.replaceSelections(o)}});